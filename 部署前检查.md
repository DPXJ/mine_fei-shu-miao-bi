# ⚡ 部署前最后检查

## 📋 文件清单

### ✅ 已创建的文件

#### 后端文件
- [x] backend_py/main.py
- [x] backend_py/requirements.txt
- [x] backend_py/.env.example
- [x] backend_py/routers/__init__.py
- [x] backend_py/routers/auth.py
- [x] backend_py/routers/documents.py
- [x] backend_py/routers/ai.py
- [x] backend_py/services/__init__.py

#### 前端文件
- [x] frontend/package.json
- [x] frontend/tsconfig.json
- [x] frontend/next.config.js
- [x] frontend/tailwind.config.js
- [x] frontend/postcss.config.js
- [x] frontend/.eslintrc.json
- [x] frontend/.env.local.example
- [x] frontend/next-env.d.ts
- [x] frontend/public/robots.txt
- [x] frontend/src/app/page.tsx
- [x] frontend/src/app/layout.tsx
- [x] frontend/src/app/globals.css
- [x] frontend/src/app/auth/callback/page.tsx
- [x] frontend/src/app/workspace/page.tsx
- [x] frontend/src/components/EditorWorkspace.tsx
- [x] frontend/src/services/auth.ts
- [x] frontend/src/services/documents.ts
- [x] frontend/src/services/ai.ts
- [x] frontend/src/types/index.ts

#### 配置和脚本
- [x] .gitignore
- [x] LICENSE
- [x] 启动项目.bat
- [x] start_all.ps1
- [x] 启动后端.bat
- [x] 启动前端.bat
- [x] 安装依赖.bat

#### 文档
- [x] README.md
- [x] 快速开始.md
- [x] 配置指南.md
- [x] 使用演示.md
- [x] 项目结构.md
- [x] 开发检查清单.md
- [x] 版本历史.md
- [x] 项目交付说明.md
- [x] 部署前检查.md

### ⚠️ 需要手动创建的文件

#### 后端
- [ ] **backend_py/.env** - 复制自 .env.example，填写实际配置
  ```env
  FEISHU_APP_ID=你的AppID
  FEISHU_APP_SECRET=你的AppSecret
  FEISHU_REDIRECT_URI=http://localhost:3000/auth/callback
  GEMINI_API_KEY=你的GeminiKey
  BACKEND_URL=http://localhost:8000
  FRONTEND_URL=http://localhost:3000
  ```

#### 前端
- [ ] **frontend/.env.local** - 复制自 .env.local.example
  ```env
  NEXT_PUBLIC_API_URL=http://localhost:8000
  ```

---

## 🔑 获取必需的密钥

### 1. 飞书应用配置（5分钟）

**步骤：**
1. 访问 https://open.feishu.cn/
2. 点击"创建企业自建应用"
3. 填写应用信息（名称：飞书妙笔）
4. 进入"权限管理" → 添加权限：
   - `docx:document` 
   - `drive:drive`
5. 进入"安全设置" → 添加重定向URL：
   - `http://localhost:3000/auth/callback`
6. 进入"凭证与基础信息" → 获取：
   - **App ID** (cli_xxxxx)
   - **App Secret**

**记录下来：**
```
App ID: ___________________
App Secret: ___________________
```

### 2. Google Gemini配置（2分钟）

**步骤：**
1. 访问 https://makersuite.google.com/app/apikey
2. 登录Google账号
3. 点击"Create API Key"
4. 选择或创建一个Google Cloud项目
5. 复制生成的API Key

**记录下来：**
```
Gemini API Key: ___________________
```

---

## 🚀 启动前检查

### 环境检查
- [ ] Node.js 18+ 已安装
  ```bash
  node --version
  ```
- [ ] Python 3.10+ 已安装
  ```bash
  python --version
  ```
- [ ] npm 已安装
  ```bash
  npm --version
  ```

### 依赖安装
- [ ] 后端依赖已安装
  ```bash
  cd backend_py
  python -m venv venv
  venv\Scripts\activate
  pip install -r requirements.txt
  ```
- [ ] 前端依赖已安装
  ```bash
  cd frontend
  npm install
  ```

### 配置检查
- [ ] backend_py/.env 文件已创建
- [ ] backend_py/.env 中所有变量已填写
- [ ] frontend/.env.local 文件已创建
- [ ] frontend/.env.local 中API_URL正确

### 飞书应用检查
- [ ] 飞书应用已创建
- [ ] 权限已添加
- [ ] 重定向URL已配置
- [ ] App ID和Secret已获取

### Gemini检查
- [ ] API Key已获取
- [ ] API Key已测试（可选）
- [ ] 确认有免费配额

---

## 🎯 首次启动步骤

### 方法一：使用启动脚本（推荐）

1. **Windows批处理：**
   ```bash
   双击：启动项目.bat
   ```

2. **PowerShell：**
   ```powershell
   右键：start_all.ps1 → 使用PowerShell运行
   ```

### 方法二：手动启动

1. **启动后端（终端1）：**
   ```bash
   cd backend_py
   python main.py
   ```
   看到 "Application startup complete" 表示成功

2. **启动前端（终端2）：**
   ```bash
   cd frontend
   npm run dev
   ```
   看到 "Ready in xxxms" 表示成功

3. **访问应用：**
   ```
   打开浏览器：http://localhost:3000
   ```

---

## ✅ 功能测试清单

### 基础测试（5分钟）

1. **登录测试**
   - [ ] 访问 http://localhost:3000
   - [ ] 点击"通过飞书登录"
   - [ ] 授权成功并跳转回应用
   - [ ] 看到文档列表页面

2. **文档列表测试**
   - [ ] 能看到飞书文档列表
   - [ ] 搜索功能正常
   - [ ] 点击文档能打开

3. **内容解析测试**
   - [ ] 左侧能看到提取的文本
   - [ ] 图片能正常显示
   - [ ] 素材展示清晰

4. **AI生成测试**
   - [ ] 输入指令："帮我整理成一篇文章"
   - [ ] 点击"生成"按钮
   - [ ] 等待10-30秒
   - [ ] 右侧显示生成的文章

5. **多轮对话测试**
   - [ ] 输入精修指令："第一段改得更简洁"
   - [ ] 点击"发送"
   - [ ] 文章更新成功
   - [ ] 对话历史正确显示

6. **导出测试**
   - [ ] 点击"复制"按钮
   - [ ] 粘贴到记事本
   - [ ] 内容完整

### 错误处理测试（可选）

- [ ] 网络断开时有友好提示
- [ ] 输入空指令时有提示
- [ ] Token过期能正确提示

---

## 🐛 常见启动问题

### 问题1：端口被占用

**错误信息：**
```
Error: listen EADDRINUSE: address already in use :::3000
```

**解决方案：**
```bash
# 查找占用进程
netstat -ano | findstr :3000
# 结束进程
taskkill /PID [进程ID] /F
```

### 问题2：依赖安装失败

**Python依赖：**
```bash
# 升级pip
python -m pip install --upgrade pip
# 重新安装
pip install -r requirements.txt
```

**Node依赖：**
```bash
# 清理缓存
npm cache clean --force
# 删除node_modules
rmdir /s /q node_modules
# 重新安装
npm install
```

### 问题3：飞书登录失败

**检查项：**
- [ ] App ID是否正确
- [ ] App Secret是否正确
- [ ] 重定向URI是否完全匹配
- [ ] 应用权限是否已添加

### 问题4：AI生成失败

**检查项：**
- [ ] Gemini API Key是否正确
- [ ] 网络能否访问Google服务
- [ ] API配额是否充足
- [ ] 后端日志查看具体错误

---

## 📊 性能检查

启动成功后，检查以下性能指标：

- [ ] 首页加载 < 3秒
- [ ] 文档列表加载 < 2秒
- [ ] 页面交互响应 < 100ms
- [ ] AI生成响应 10-30秒（正常）

---

## 🎉 启动成功标志

当你看到以下画面，说明项目启动成功：

1. ✅ 后端终端显示：
   ```
   INFO:     Application startup complete.
   INFO:     Uvicorn running on http://0.0.0.0:8000
   ```

2. ✅ 前端终端显示：
   ```
   ✓ Ready in 2.5s
   ○ Local:   http://localhost:3000
   ```

3. ✅ 浏览器打开 http://localhost:3000 看到欢迎页面

4. ✅ 点击登录后能正常跳转飞书授权页

5. ✅ 授权后能看到文档列表

6. ✅ 选择文档后能看到素材和创作区

7. ✅ 输入指令后AI能正常生成

---

## 🎯 下一步

启动成功后，建议：

1. 📖 阅读 [使用演示.md](./使用演示.md) 了解所有功能
2. 🧪 尝试不同的创作指令
3. 💡 探索多轮对话能力
4. 🚀 开始您的创作之旅

---

**祝您使用愉快！🎊**


